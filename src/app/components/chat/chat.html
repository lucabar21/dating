<div class="chat-wrapper" #chatComponent [style.visibility]="chatVisible() ? 'visible' : 'hidden'">
  <div
    class="message-box"
    *ngFor="let message of messages()"
    [ngClass]="message.mittenteId === currentUser()?.id ? 'sent' : 'received'"
  >
    <p>{{ message.contenuto }}</p>
    <span class="timestamp">{{ message.timestamp | date: 'short' }}</span>
  </div>

    <!-- ✅ New message scroll-to-bottom button -->
  <button
    *ngIf="showScrollButton()"
    class="scroll-to-bottom"
    (click)="scrollToBottom(); showScrollButton.set(false); newMessageCount.set(0)"
  >
    ⬇️
    <span class="badge" *ngIf="newMessageCount() > 0">{{ newMessageCount() }}</span>
  </button>
</div>
